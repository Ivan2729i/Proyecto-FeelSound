{% extends 'base.html' %}
{% load static %}
{% load socialaccount %}

{% block title %}Dashboard • FeelSound{% endblock %}

{% block content %}
<!-- TOPBAR -->
<header id="fs-topbar" class="sticky top-0 z-40 w-full border-b border-white/10 bg-[#0B1E5B]/90 backdrop-blur">
  <div class="px-4 sm:px-5 lg:px-8 h-16 flex items-center gap-3 sm:gap-6">
    <!-- Logo -->
    <a href="{% url 'home:dashboard' %}" class="flex items-center gap-2 shrink-0">
      <span aria-hidden="true" class="inline-flex items-center justify-center w-9 h-9 rounded-xl bg-red-500/15">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-red-500" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 3a9 9 0 0 0-9 9v6a3 3 0 0 0 3 3h1a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2H5v-1a7 7 0 0 1 14 0v1h-2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h1a3 3 0 0 0 3-3v-6a9 9 0 0 0-9-9z"/>
        </svg>
      </span>
      <span class="text-white text-2xl md:text-3xl font-extrabold tracking-tight hover:opacity-90">FeelSound</span>
    </a>

    <!-- Menú móvil -->
    <div class="md:hidden ml-auto">
      <button class="btn-fs btn-fs--hover-purple px-3 py-1.5 rounded-lg ">Menú</button>
    </div>

    <div class="hidden md:flex items-center gap-3 flex-1">
      <span class="text-white/80">¿Cómo te sientes hoy?</span>
      <div id="fs-emoji-row" class="flex items-center gap-1.5">
        <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
              type="button" data-emoji="happy" data-active="true" title="Feliz" aria-label="Feliz">😁</button>
        <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
                type="button" data-emoji="sad" data-active="false" title="Triste" aria-label="Triste">😢</button>
        <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
                type="button" data-emoji="love" data-active="false" title="Amor" aria-label="Amor">🥰</button>
        <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
                type="button" data-emoji="angry" data-active="false" title="Enojado" aria-label="Enojado">😡</button>
        <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
                type="button" data-emoji="calm" data-active="false" title="Calmado" aria-label="Calmado">😴</button>
        <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
                type="button" data-emoji="neutral" data-active="false" title="Neutral" aria-label="Neutral">😐</button>
      </div>
    </div>

    <div class="hidden md:flex items-center gap-4">
      <span class="text-white/80">
        Bienvenido, <strong>{{ user.username }}</strong>
      </span>
      <a id="btn-logout" href="{% url 'account_logout' %}" class="inline-flex items-center gap-2 px-3 py-1.5 rounded-lg btn-fs btn-fs--hover-purple">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M16 13v-2H7V8l-5 4 5 4v-3h9zM20 3h-8v2h8v14h-8v2h8a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/>
        </svg>
        Cerrar sesión
      </a>
    </div>
  </div>

  <!-- Emojis en móvil -->
  <div class="md:hidden px-4 pb-3">
    <div class="text-white/80 text-sm mb-2">¿Cómo te sientes hoy?</div>
    <div class="flex items-center gap-2 overflow-x-auto no-scrollbar -mx-1 px-1">
      <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
              type="button" data-emoji="happy" data-active="true" title="Feliz" aria-label="Feliz">😁</button>
      <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
              type="button" data-emoji="sad" data-active="false" title="Triste" aria-label="Triste">😢</button>
      <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
              type="button" data-emoji="love" data-active="false" title="Amor" aria-label="Amor">🥰</button>
      <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
              type="button" data-emoji="angry" data-active="false" title="Enojado" aria-label="Enojado">😡</button>
      <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
              type="button" data-emoji="calm" data-active="false" title="Calmado" aria-label="Calmado">😴</button>
      <button class="emoji-chip text-2xl leading-none rounded-full p-1.5 hover:bg-white/10 data-[active=true]:ring-2 data-[active=true]:ring-white/40"
              type="button" data-emoji="neutral" data-active="false" title="Neutral" aria-label="Neutral">😐</button>
    </div>
  </div>
</header>

<!-- Overlay móvil para cerrar el menú -->
<div id="fs-overlay" class="fixed inset-0 bg-black/50 opacity-0 pointer-events-none md:hidden transition-opacity"></div>

<!-- LAYOUT: Sidebar + Contenido -->
<div class="flex">

  <!-- SIDEBAR (off-canvas en móvil, fija en desktop) -->
  <aside id="fs-sidebar"
    class="fixed top-16 left-0 h-[calc(100dvh-4rem)] w-72 bg-[#0B1E5B]/90 border-r border-white/10
           -translate-x-full transition-transform md:translate-x-0 md:static md:h-[calc(100vh-4rem)] md:w-64">

    <nav class="h-full overflow-y-auto no-scrollbar p-4 space-y-6">
      <!-- Sección principal -->
      <div class="space-y-1">
        <!-- Activo: bg-white/15 text-white -->
        <a href="#/dashboard"
           class="fs-navitem group flex items-center gap-3 px-3 py-2 rounded-lg text-white bg-white/15 hover:bg-white/20">
          <!-- icono biblioteca -->
          <svg class="w-5 h-5 opacity-90" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M4 6a2 2 0 0 1 2-2h3v16H6a2 2 0 0 1-2-2V6zm7-2h3a2 2 0 0 1 2 2v14h-5V4zm8 2a2 2 0 0 0-2-2h-1v16h1a2 2 0 0 0 2-2V6z"/>
          </svg>
          <span class="font-medium">Biblioteca Musical</span>
        </a>

        <a href="#/perfil"
           class="fs-navitem group flex items-center gap-3 px-3 py-2 rounded-lg text-white/80 hover:text-white hover:bg-white/10">
          <!-- icono usuario -->
          <svg class="w-5 h-5 opacity-90" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5zm0 2c-4.33 0-8 2.17-8 5v1h16v-1c0-2.83-3.67-5-8-5z"/>
          </svg>
          <span class="font-medium">Perfil</span>
        </a>

        <a href="#/playlists"
           class="fs-navitem group flex items-center gap-3 px-3 py-2 rounded-lg text-white/80 hover:text-white hover:bg-white/10">
          <!-- icono lista -->
          <svg class="w-5 h-5 opacity-90" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M3 5h14v2H3V5zm0 6h14v2H3v-2zm0 6h10v2H3v-2zM19 5h2v2h-2V5zm0 6h2v2h-2v-2zm0 6h2v2h-2v-2z"/>
          </svg>
          <span class="font-medium">Mis playlists</span>
        </a>

        <a href="#/playlist/new"
           class="fs-navitem group flex items-center gap-3 px-3 py-2 rounded-lg text-white/80 hover:text-white hover:bg-white/10">
          <!-- icono más -->
          <svg class="w-5 h-5 opacity-90" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M11 11V6h2v5h5v2h-5v5h-2v-5H6v-2z"/>
          </svg>
          <span class="font-medium">Crear playlist</span>
        </a>
      </div>

      <!-- Separador -->
      <div class="pt-1">
        <div class="px-3 text-xs uppercase tracking-wider text-white/50 mb-2">Listas de reproducción</div>
        <div class="space-y-1">
          <a href="#/playlists/1" class="block px-3 py-2 rounded-lg text-white/80 hover:text-white hover:bg-white/10">Prueba 1</a>
          <a href="#/playlists/2" class="block px-3 py-2 rounded-lg text-white/80 hover:text-white hover:bg-white/10">Focus Beats</a>
          <a href="#/playlists/3" class="block px-3 py-2 rounded-lg text-white/80 hover:text-white hover:bg-white/10">Workout Hits</a>
        </div>
      </div>
    </nav>
  </aside>

  <!-- CONTENIDO principal -->
  <main id="fs-content" class="bg-fs-dif flex-1 p-4 md:p-6 lg:p-8 h-[calc(100dvh-64px-96px)] overflow-hidden">
    <!-- === VIEW: Biblioteca Musical === -->
    <section id="view-dashboard" class="space-y-6 ">
      <!-- Encabezado -->
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div>
          <h1 class="text-3xl font-bold text-white">Tu Música</h1>
          <p class="text-[#4CC9F0] font-medium">Estado de ánimo: <span id="fs-mood-label">Feliz</span></p>
        </div>

        <!-- Buscador -->
        <div class="w-full sm:w-72 lg:w-80 relative">
          <input
            id="fs-search"
            type="text"
            placeholder="Buscar canciones, artistas, álbum..."
            class="w-full h-10 bg-white/5 border border-white/10 rounded-xl pl-10 pr-3 outline-none text-sm placeholder:text-white/40 focus:border-white/20 focus:ring-0 text-white"
          />
          <svg xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 24 24"
               fill="none"
               stroke="currentColor"
               stroke-width="2"
               stroke-linecap="round"
               stroke-linejoin="round"
               class="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-white/70 pointer-events-none">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
        </div>
      </div>

      <!-- Tabla de canciones -->
      <div class="rounded-2xl bg-white/5 backdrop-blur border border-white/10 overflow-hidden shadow-lg">
        <div id="fs-songs-scroll"
             class="overflow-y-auto pr-1"
             style="height: calc(100dvh - 64px - 96px - 8rem);">
          <table class="min-w-full divide-y divide-white/10 text-sm text-white/80">
            <thead class="sticky top-0 z-10 bg-[#0B1E5B] text-white/80 text-xs uppercase tracking-wider shadow-[0_1px_0_0_rgba(255,255,255,.08)]">
              <tr>
                <th class="px-4 py-3 text-left font-medium">#</th>
                <th class="px-4 py-3 text-left font-medium">Título</th>
                <th class="px-4 py-3 text-left font-medium">Álbum</th>
                <th class="px-4 py-3 text-left font-medium">Duración</th>
              </tr>
            </thead>
            <tbody id="fs-results-body" class="divide-y divide-white/5 cursor-pointer"></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- === VIEW: Perfil === -->
    <section id="view-profile" class="space-y-6" hidden>
      <!-- Encabezado -->
      <div>
        <h1 class="text-3xl font-bold text-white">Mi Perfil</h1>
      </div>
      <!-- Info de usuario + Estadísticas -->
      <div class="grid grid-cols-1 xl:grid-cols-2 gap-6">
        <!-- Card: Info de usuario -->
        <div class="relative rounded-2xl bg-white/5 backdrop-blur border border-white/10 p-5">
          <!-- Botón Editar -->
          <button id="pf-edit-btn"
            class="absolute right-4 top-4 inline-flex items-center gap-2 px-3 py-1.5 rounded-xl
                   bg-white/5 border border-white/10 backdrop-blur
                   text-white/90 hover:text-white
                   hover:bg-white/10 hover:shadow-[0_0_0_1px_rgba(255,255,255,.12)]
                   focus:outline-none focus:ring-2 focus:ring-white/20 active:scale-[.98] transition">
            <svg class="w-4 h-4 opacity-90" viewBox="0 0 24 24" fill="currentColor">
              <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zm2.92 2.83H5v-.92l9.06-9.06.92.92L5.92 20.08zM20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"/>
            </svg>
            Editar
          </button>


          <div class="flex items-center gap-4">
            <img
              id="pf-avatar"
              src="{% static 'img/avatar_default.png' %}"
              data-default-src="{% static 'img/avatar_default.png' %}"
              alt="Avatar"
              class="w-16 h-16 rounded-full object-cover bg-white/10"
              data-google-photo="{{ user.socialaccount_set.first.extra_data.picture|default:'' }}">
            <div>
              <div id="pf-name" class="text-xl font-semibold text-white">
                {{ user.get_full_name|default:user.username }}
              </div>
              <div id="pf-bio" class="text-white/60">
                {{ user.bio|default:'Amante de la música' }}
              </div>
              <div class="text-xs text-white/40 mt-0.5">
                @<span id="pf-username">{{ user.username }}</span>
              </div>
            </div>
          </div>

          <div class="mt-7 space-y-3 text-white/80">
            <div class="flex items-center gap-4 text-white/80">
              <span class="inline-flex h-6 w-6 items-center justify-center rounded-lg bg-white/10 ring-1 ring-white/10">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round"
                        d="M21.75 7.5v9a2.25 2.25 0 01-2.25 2.25H4.5A2.25 2.25 0 012.25 16.5v-9m19.5 0A2.25 2.25 0 0019.5 5.25h-15A2.25 2.25 0 002.25 7.5m19.5 0L12 14.25 2.25 7.5" />
                </svg>
              </span>
              <span id="pf-email" class="truncate">{{ user.email }}</span>
            </div>

            <div class="flex items-center gap-4 text-white/80">
              <span class="inline-flex h-6 w-6 items-center justify-center rounded-lg bg-white/10 ring-1 ring-white/10">
                <!-- Calendar (outline) -->
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round"
                        d="M8 2.75v2.5M16 2.75v2.5M3.75 9.5h16.5M5.25 5.25h13.5A2.25 2.25 0 0121 7.5v9A2.25 2.25 0 0118.75 18.75H5.25A2.25 2.25 0 013 16.5v-9A2.25 2.25 0 015.25 5.25z" />
                </svg>
              </span>
              <span>
                Miembro desde
                <span id="pf-member-since" data-joined="{{ user.date_joined|date:'c' }}">—</span>
              </span>
            </div>
          </div>
        </div>

        <!-- Card: Estadísticas -->
        <div class="rounded-2xl bg-white/5 backdrop-blur border border-white/10 p-5">
          <h2 class="text-white/90 font-semibold mb-4">Estadísticas</h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="rounded-xl bg-white/5 border border-white/10 p-4">
              <div class="text-white/60 text-sm">Tiempo total de escucha</div>
              <div id="pf-listen-time" class="text-2xl font-bold text-white mt-1">0 min</div>
            </div>
            <div class="rounded-xl bg-white/5 border border-white/10 p-4">
              <div class="text-white/60 text-sm">Emoción favorita</div>
              <div id="pf-fav-mood" class="text-2xl font-bold text-white mt-1">—</div>
            </div>
            <div class="rounded-xl bg-white/5 border border-white/10 p-4">
              <div class="text-white/60 text-sm">Canciones reproducidas</div>
              <div id="pf-total-plays" class="text-2xl font-bold text-white mt-1">0</div>
            </div>
            <div class="rounded-xl bg-white/5 border border-white/10 p-4">
              <div class="text-white/60 text-sm">Canciones Favoritas</div>
              <div id="pf-fav-count" class="text-2xl font-bold text-white mt-1">—</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Reproducidas recientemente -->
      <div class="rounded-2xl bg-white/5 backdrop-blur border border-white/10 p-5">
        <div class="flex items-center justify-between mb-3">
          <h2 class="text-white/90 font-semibold">Reproducidas recientemente</h2>
        </div>
        <div id="pf-recent-list" class="divide-y divide-white/10">
        </div>
      </div>
    </section>


    <!-- PLAYER BAR -->
    <footer id="fs-playerbar"
      class="fixed bottom-0 left-0 right-0 z-40 border-t border-white/10 bg-black/40 backdrop-blur">
      <div class="max-w-7xl mx-auto px-4 md:px-6 py-3
                  grid grid-cols-[320px_1fr_180px] items-center gap-4">

        <!-- Izquierda: cover + info -->
        <div class="flex items-center gap-3 min-w-0">
          <img id="player-cover" loading="lazy" src="{% static 'img/no_music.png' %}" alt="Imagen Defecto" data-default-src="{% static 'img/no_music.png' %}"
               class="w-12 h-12 rounded-lg object-cover bg-white/10 img-placeholder" />
          <div class="min-w-0">
            <div id="player-title" class="fs-marquee max-w-[260px]">
              <div class="fs-marq-track">
                <span id="player-title-text" class="fs-marq-item text-white">Nada sonando</span>
                <span class="fs-marq-item fs-marq-dup text-white" aria-hidden="true"></span>
              </div>
            </div>
            <div id="player-artist"
                 class="fs-marquee max-w-[260px] text-white/60 text-sm">
              <div class="fs-marq-track">
                <span id="player-artist-text" class="fs-marq-item">--</span>
              </div>
            </div>
          </div>
          <button id="btn-like"
            class="ml-2 hidden sm:grid place-items-center w-9 h-9 rounded-full bg-white/10 hover:bg-white/20"
            aria-label="Agregar a favoritos" aria-pressed="false">
            <svg class="w-5 h-5 text-white/90" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"/>
            </svg>
          </button>
        </div>

        <!-- Centro: controles + progreso -->
        <div class="min-w-0 flex flex-col items-center gap-2">
          <div class="flex items-center gap-2">
            <!-- Prev -->
            <button id="btn-prev"
              class="p-2 grid place-items-center text-white/90 hover:text-white cursor-pointer"
              aria-label="Anterior">
              <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none"
                   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="19 20 9 12 19 4 19 20"></polygon>
                <line x1="5" y1="19" x2="5" y2="5"></line>
              </svg>
            </button>
            <!-- Play / Pause -->
            <button id="btn-play"
              class="w-10 h-10 rounded-full bg-white text-black hover:bg-white/90 grid place-items-center cursor-pointer"
              aria-label="Reproducir" data-state="paused">
              <!-- Play -->
              <svg class="icon-play w-5 h-5" viewBox="0 0 24 24" fill="none"
                   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="6 4 20 12 6 20 6 4"></polygon>
              </svg>
              <!-- Pause -->
              <svg class="icon-pause w-5 h-5 hidden" viewBox="0 0 24 24" fill="none"
                   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="6" y="4" width="4" height="16"></rect>
                <rect x="14" y="4" width="4" height="16"></rect>
              </svg>
            </button>
            <!-- Next -->
            <button id="btn-next"
              class="p-2 grid place-items-center text-white/90 hover:text-white cursor-pointer"
              aria-label="Siguiente">
              <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none"
                   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="5 4 15 12 5 20 5 4"></polygon>
                <line x1="19" y1="5" x2="19" y2="19"></line>
              </svg>
            </button>
            <!-- Botón repeat-one -->
            <button
              id="btn-repeat-one"
              type="button"
              aria-pressed="false"
              title="Repetir esta canción"
              class="relative inline-flex h-9 w-9 items-center justify-center rounded-full
                     transition-transform duration-150 ease-out opacity-80
                     hover:opacity-100 hover:scale-[1.04]
                     aria-pressed:bg-white/10 cursor-pointer">
              <svg viewBox="0 0 24 24" aria-hidden="true"
                   class="h-[18px] w-[18px] text-white aria-pressed:text-white "
                   fill="currentColor">
                <path d="M17 1l4 4-4 4V6H7a3 3 0 000 6h2v2H7a5 5 0 110-10h10V1zM7 23l-4-4 4-4v3h10a3 3 0 000-6h-2v-2h2a5 5 0 010 10H7v3z"/>
              </svg>
            </button>
          </div>

          <div class="w-full flex items-center gap-2 text-xs text-white/70">
            <span id="player-time-current" class="tabular-nums">0:00</span>
            <input id="player-seek" type="range" min="0" max="100" value="0"
                   class="fs-range flex-1 h-1.5 rounded-full accent-white/80 cursor-pointer">
            <span id="player-time-total" class="tabular-nums">0:30</span>
          </div>
        </div>

        <!-- Derecha: volumen -->
        <div class="hidden sm:flex items-center gap-3 justify-end">
          <svg class="w-6 h-6 md:w-7 md:h-7 text-white/90" viewBox="0 0 24 24" fill="none"
               stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
            <path d="M19.07 4.93a9 9 0 0 1 0 14.14"></path>
          </svg>
          <input id="player-volume" type="range" min="0" max="100" value="70"
                 class="fs-range w-28 h-1.5 rounded-full accent-white/80 cursor-pointer">
        </div>
      </div>

      <audio id="fs-audio" preload="auto" crossorigin="anonymous"></audio>
    </footer>

    <!-- Modal Editar Perfil -->
    <div id="pf-edit-modal"
         class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden items-center justify-center z-50">
      <div class="w-full max-w-md rounded-2xl bg-slate-900/90 border border-white/10 p-5">
        <h3 class="text-white font-semibold mb-4">Editar perfil</h3>

        <form id="pf-edit-form" class="space-y-4">
          <!-- Username -->
          <div>
            <label class="text-white/70 text-sm">Nombre de usuario</label>
            <input id="pf-inp-username"
                   class="w-full mt-1 rounded-lg bg-white/5 border border-white/10 px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-white/20"
                   maxlength="150" />
            <p id="pf-username-error" class="text-red-400 text-xs mt-1 hidden"></p>
          </div>
          <!-- Bio -->
          <div>
            <label class="text-white/70 text-sm">Bio</label>
            <textarea id="pf-inp-bio" rows="3"
                      class="w-full mt-1 rounded-lg bg-white/5 border border-white/10 px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-white/20"
                      placeholder="Cuéntanos algo sobre ti…"></textarea>
          </div>
          <!-- Foto de perfil -->
          <div>
            <label class="text-white/70 text-sm">Foto de perfil</label>

            <div id="pf-drop"
                 class="mt-2 flex items-center gap-4 rounded-2xl border border-dashed border-white/15 bg-white/5 hover:bg-white/10 transition p-3 cursor-pointer">
              <img id="pf-edit-preview"
                   class="w-16 h-16 rounded-full object-cover bg-white/10"
                   src=""
                   alt="Preview" />
              <div class="flex-1">
                <p class="text-white/80 text-sm">Arrastra una imagen aquí o haz clic para seleccionar</p>
                <div class="mt-3 flex items-center gap-2">
                  <label for="pf-inp-avatar"
                         class="inline-flex items-center gap-2 px-3 py-1.5 rounded-lg btn-fs btn-fs--hover-purple text-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-8" viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18h14v2H5z"/></svg>
                    Elegir imagen
                  </label>
                  <span id="pf-file-name" class="text-white/50 text-xs pl-4">PNG/JPG · máx 3 MB</span>
                </div>
                <input id="pf-inp-avatar" type="file" accept="image/*" class="hidden" />
              </div>
              <button type="button" id="pf-clear-avatar"
                      class="text-white/60 text-xs underline hover:text-white/90">Quitar</button>
            </div>
            <p id="pf-avatar-error" class="text-red-400 text-xs mt-1 hidden"></p>
          </div>
          <!-- Botones -->
          <div class="flex justify-end gap-2 pt-2">
            <button type="button" id="pf-cancel"
                    class="inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border border-white/15 text-white/90 hover:bg-white/10">
              Cancelar
            </button>
            <button type="submit" id="pf-save-btn"
                    class="inline-flex items-center gap-2 px-3 py-1.5 rounded-lg btn-fs btn-fs--hover-purple">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/></svg>
              Guardar
            </button>
          </div>
        </form>
      </div>
    </div>
  </main>
</div>

{% endblock %}

{% block scripts %}
<script src="{% static 'js/main.js' %}"></script>
<script src="{% static 'js/dz.js' %}"></script>
{% endblock %}
